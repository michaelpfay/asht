"0","library(exact2x2)"
"0","library(asht)"
"0","# show that p2-p1 < M"
"0","# this is equivalent to the upper confidence "
"0","# limit for p2-p1 being < M"
"0","M<- 0.10"
"0","THETA1<- 0.20"
"0","THETA2<- 0.20"
"0",""
"0",""
"0","decFunc<-function(data,margin=M){"
"0","  # binomMeld.test gives central CIs, and the"
"0","  # two-sided 95% central confidence interval"
"0","  # bounds the error on each side at 2.5% "
"0","  ci<-binomMeld.test(x1=data$x1,"
"0","                     n1=data$n1,"
"0","                     x2=data$x2,"
"0","                     n2=data$n2,conf.level=0.95)$conf.int"
"0","  ifelse(ci[2]<margin,1,0)"
"0","}"
"0","dataGenFunc<-function(n,theta1=THETA1,"
"0","                      theta2=THETA2){"
"0","  n<-ceiling(n)"
"0","  out<-list(x1=rbinom(1,n,theta1),"
"0","            n1=n,"
"0","            x2=rbinom(1,n,theta2),"
"0","            n2=n)"
"0","  #print(out)"
"0","  out"
"0","}"
"0",""
"0","# estimated sample size per arm, with no missingness"
"0","set.seed(40201)"
"0","n.with.10pct.margin<-simulateSS(decFunc, dataGenFunc, nstart=300,power=0.90, alpha=0.025, printSteps=TRUE)$Nestimate"
"1","[1]"
"1"," ""Step 1: n= 300 simulated power(n)= 0.82"""
"1","
"
"1","[1]"
"1"," ""Step  2 : n= 190.639270156626 simulated power(n)= 0.63"""
"1","
"
"1","[1]"
"1"," ""Step  3 : n= 381.278540313252 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  4 : n= 762.557080626503 simulated power(n)= 0.995"""
"1","
"
"1","[1]"
"1"," ""Step  5 : n= 381 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  6 : n= 362 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  7 : n= 345 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  8 : n= 332 simulated power(n)= 0.83"""
"1","
"
"1","[1]"
"1"," ""Step  9 : n= 341 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  10 : n= 342 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  11 : n= 343 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  12 : n= 343 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  13 : n= 343 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  14 : n= 342 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  15 : n= 341 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  16 : n= 340 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  17 : n= 341 simulated power(n)= 0.85"""
"1","
"
"1","[1]"
"1"," ""Step  18 : n= 342 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  19 : n= 343 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  20 : n= 344 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  21 : n= 343 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  22 : n= 344 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  23 : n= 345 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  24 : n= 346 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  25 : n= 347 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  26 : n= 348 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  27 : n= 347 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  28 : n= 348 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  29 : n= 349 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  30 : n= 350 simulated power(n)= 0.86"""
"1","
"
"1","[1]"
"1"," ""Step  31 : n= 351 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  32 : n= 350 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  33 : n= 349 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  34 : n= 350 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  35 : n= 351 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  36 : n= 350 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  37 : n= 349 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  38 : n= 348 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  39 : n= 347 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  40 : n= 346 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  41 : n= 347 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  42 : n= 346 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  43 : n= 347 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  44 : n= 348 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  45 : n= 347 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  46 : n= 346 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  47 : n= 345 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  48 : n= 344 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  49 : n= 343 simulated power(n)= 0.84"""
"1","
"
"1","[1]"
"1"," ""Step  50 : n= 344 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  51 : n= 343 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  52 : n= 342 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  53 : n= 343 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  54 : n= 344 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  55 : n= 345 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  56 : n= 346 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  57 : n= 347 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  58 : n= 346 simulated power(n)= 0.85"""
"1","
"
"1","[1]"
"1"," ""Step  59 : n= 347 simulated power(n)= 0.84"""
"1","
"
"1","[1]"
"1"," ""Step  60 : n= 348 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  61 : n= 349 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  62 : n= 348 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  63 : n= 347 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  64 : n= 346 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  65 : n= 347 simulated power(n)= 0.83"""
"1","
"
"1","[1]"
"1"," ""Step  66 : n= 348 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  67 : n= 349 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  68 : n= 348 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  69 : n= 347 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  70 : n= 348 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  71 : n= 349 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  72 : n= 348 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  73 : n= 349 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  74 : n= 350 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  75 : n= 351 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  76 : n= 350 simulated power(n)= 0.86"""
"1","
"
"1","[1]"
"1"," ""Step  77 : n= 351 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  78 : n= 350 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  79 : n= 349 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  80 : n= 350 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  81 : n= 349 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  82 : n= 348 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  83 : n= 347 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  84 : n= 346 simulated power(n)= 0.84"""
"1","
"
"1","[1]"
"1"," ""Step  85 : n= 347 simulated power(n)= 0.84"""
"1","
"
"1","[1]"
"1"," ""Step  86 : n= 348 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  87 : n= 349 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  88 : n= 350 simulated power(n)= 0.85"""
"1","
"
"1","[1]"
"1"," ""Step  89 : n= 351 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  90 : n= 352 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  91 : n= 353 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  92 : n= 352 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  93 : n= 353 simulated power(n)= 0.86"""
"1","
"
"1","[1]"
"1"," ""Step  94 : n= 354 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  95 : n= 353 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  96 : n= 354 simulated power(n)= 0.84"""
"1","
"
"1","[1]"
"1"," ""Step  97 : n= 355 simulated power(n)= 0.86"""
"1","
"
"1","[1]"
"1"," ""Step  98 : n= 356 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  99 : n= 357 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  100 : n= 356 simulated power(n)= 0.95"""
"1","
"
"0","M<- 0.05"
"0","decFunc<-function(data,margin=M){"
"0","  ci<-binomMeld.test(x1=data$x1,"
"0","                     n1=data$n1,"
"0","                     x2=data$x2,"
"0","                     n2=data$n2,conf.level=0.95)$conf.int"
"0","  ifelse(ci[2]<margin,1,0)"
"0","}"
"0","n.with.5pct.margin<-simulateSS(decFunc, dataGenFunc, nstart=500,power=0.90, alpha=0.025, printSteps=TRUE)$Nestimate"
"1","[1]"
"1"," ""Step 1: n= 500 simulated power(n)= 0.42"""
"1","
"
"1","[1]"
"1"," ""Step  2 : n= 849.89182411972 simulated power(n)= 0.73"""
"1","
"
"1","[1]"
"1"," ""Step  3 : n= 1699.78364823944 simulated power(n)= 0.98"""
"1","
"
"1","[1]"
"1"," ""Step  4 : n= 3399.56729647888 simulated power(n)= 0.995"""
"1","
"
"1","[1]"
"1"," ""Step  5 : n= 1428 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  6 : n= 1502 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  7 : n= 1456 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  8 : n= 1445 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  9 : n= 1445 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  10 : n= 1441 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  11 : n= 1441 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  12 : n= 1441 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  13 : n= 1440 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  14 : n= 1441 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  15 : n= 1442 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  16 : n= 1441 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  17 : n= 1440 simulated power(n)= 0.96"""
"1","
"
"1","[1]"
"1"," ""Step  18 : n= 1439 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  19 : n= 1438 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  20 : n= 1439 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  21 : n= 1440 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  22 : n= 1441 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  23 : n= 1440 simulated power(n)= 0.85"""
"1","
"
"1","[1]"
"1"," ""Step  24 : n= 1441 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  25 : n= 1440 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  26 : n= 1439 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  27 : n= 1438 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  28 : n= 1437 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  29 : n= 1438 simulated power(n)= 0.98"""
"1","
"
"1","[1]"
"1"," ""Step  30 : n= 1437 simulated power(n)= 0.84"""
"1","
"
"1","[1]"
"1"," ""Step  31 : n= 1438 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  32 : n= 1437 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  33 : n= 1436 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  34 : n= 1437 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  35 : n= 1438 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  36 : n= 1437 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  37 : n= 1436 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  38 : n= 1435 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  39 : n= 1436 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  40 : n= 1435 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  41 : n= 1434 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  42 : n= 1433 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  43 : n= 1434 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  44 : n= 1435 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  45 : n= 1436 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  46 : n= 1437 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  47 : n= 1436 simulated power(n)= 0.98"""
"1","
"
"1","[1]"
"1"," ""Step  48 : n= 1435 simulated power(n)= 0.84"""
"1","
"
"1","[1]"
"1"," ""Step  49 : n= 1436 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  50 : n= 1437 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  51 : n= 1436 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  52 : n= 1437 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  53 : n= 1436 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  54 : n= 1435 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  55 : n= 1436 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  56 : n= 1437 simulated power(n)= 0.85"""
"1","
"
"1","[1]"
"1"," ""Step  57 : n= 1438 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  58 : n= 1437 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  59 : n= 1436 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  60 : n= 1437 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  61 : n= 1438 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  62 : n= 1439 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  63 : n= 1438 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  64 : n= 1437 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  65 : n= 1436 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  66 : n= 1437 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  67 : n= 1436 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  68 : n= 1437 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  69 : n= 1436 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  70 : n= 1435 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  71 : n= 1434 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  72 : n= 1435 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  73 : n= 1434 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  74 : n= 1433 simulated power(n)= 0.88"""
"1","
"
"1","[1]"
"1"," ""Step  75 : n= 1434 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  76 : n= 1435 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  77 : n= 1434 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  78 : n= 1433 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  79 : n= 1432 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  80 : n= 1433 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  81 : n= 1432 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  82 : n= 1431 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  83 : n= 1432 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  84 : n= 1431 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  85 : n= 1432 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  86 : n= 1431 simulated power(n)= 0.96"""
"1","
"
"1","[1]"
"1"," ""Step  87 : n= 1430 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  88 : n= 1429 simulated power(n)= 0.93"""
"1","
"
"1","[1]"
"1"," ""Step  89 : n= 1428 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  90 : n= 1427 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  91 : n= 1426 simulated power(n)= 0.89"""
"1","
"
"1","[1]"
"1"," ""Step  92 : n= 1427 simulated power(n)= 0.87"""
"1","
"
"1","[1]"
"1"," ""Step  93 : n= 1428 simulated power(n)= 0.91"""
"1","
"
"1","[1]"
"1"," ""Step  94 : n= 1427 simulated power(n)= 0.81"""
"1","
"
"1","[1]"
"1"," ""Step  95 : n= 1428 simulated power(n)= 0.9"""
"1","
"
"1","[1]"
"1"," ""Step  96 : n= 1429 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  97 : n= 1428 simulated power(n)= 0.94"""
"1","
"
"1","[1]"
"1"," ""Step  98 : n= 1427 simulated power(n)= 0.95"""
"1","
"
"1","[1]"
"1"," ""Step  99 : n= 1426 simulated power(n)= 0.92"""
"1","
"
"1","[1]"
"1"," ""Step  100 : n= 1425 simulated power(n)= 0.91"""
"1","
"
